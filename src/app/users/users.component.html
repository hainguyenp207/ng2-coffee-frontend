<ng2-toasty [position]="'top-right'"></ng2-toasty>
<div class="card-box table-responsive">
  <div class="row">
    <div class="col-md-6">
      <button type="button" class="btn btn-default btn-md waves-effect waves-light m-b-30" (click)="lgModal.show()">
        <i class="md md-add"></i> Thêm mới
    </button>
    </div>
    <div class="col-md-6">
      <a href="#import-modal" class="btn btn-success waves-effect waves-light m-b-30 pull-right" data-animation="fadein" data-plugin="custommodal"
        data-overlayspeed="200" data-overlaycolor="#36404a">
                                       Nhập từ file</a>
    </div>
  </div>
  <div class="col-lg-12">
    <table datatable id="usersDataTable" class="table table-striped table-bordered dataTable no-footer" role="grid" aria-describedby="usersDataTable_info">
      <thead>
        <tr role="row">
          <th> Tên tài khoản </th>
          <th>Họ và tên</th>
          <th>Giới tính</th>
          <th>Email</th>
          <th>Khoa</th>
          <th>Hành động</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users">
          <td>{{user.username}}</td>
          <td>{{user.name}}</td>
          <td>{{user.sex?"Nam":"Nữ"}}</td>
          <td>{{user.email}}</td>
          <td>{{user.id}}</td>
          <td>
            <a [routerLink]="['/users/edit/',(user.username)]" class="btn btn-default user">Sửa</a>
            <button data-toggle="custom-modal" data-target="#custom-modal" class="btn btn-danger del">Xóa</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>

<div class="modal fade" bsModal #lgModal="bs-modal" [config]="{backdrop: 'static'}" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content" style="padding:0;border-color: none">
      <h4 class="custom-modal-title">Tài khoản</h4>
      <div class="custom-modal-text text-left">
        <form role="form" (ngSubmit)="f.form.valid && createUser()" #f="ngForm" novalidate>
          <div class="form-group">
            <label for="name">Tên dăng nhập</label>
            <div class="input-group">
              <input type="text" name="username" class="form-control" [ngClass]="{ 'parsley-error': f.submitted}" [(ngModel)]="user.username"
                id="username" placeholder="Nhập tên đăng nhập">
              <span class="input-group-addon bg-custom b-0 text-white"><i class="fa fa-user"></i></span>
            </div>
          </div>
          <div class="form-group">
            <label for="name">Họ tên</label>
            <div class="input-group">
              <input type="text" name="name" class="form-control" [ngClass]="{ 'parsley-error': f.submitted}" [(ngModel)]="user.name" id="name"
                placeholder="Nhập họ tên">
              <span class="input-group-addon bg-custom b-0 text-white"><i class="fa fa-user"></i></span>
            </div>
          </div>
          <div class="form-group">
            <label for="exampleInputEmail1">Email</label>
            <div class="input-group">
              <input type="text" class="form-control" name="email" placeholder="Nhập email" [ngClass]="{ 'parsley-error': f.submitted }"
                [(ngModel)]="user.email">
              <span class="input-group-addon bg-custom b-0 text-white">
                <i class="fa fa-envelope"></i>
                </span>
            </div>
          </div>
          <div class="form-group">
            <label for="exampleInputEmail1">Mật khẩu</label>
            <div class="input-group">
              <input type="password" class="form-control" placeholder="Nhập mật khẩu">
              <span class="input-group-addon bg-custom b-0 text-white"><i class="fa fa-key"></i></span>
            </div>
          </div>
          <div class="row">
            <div class="col-md-5 col-xs-5">
              <div class="form-group">
                <label>Tổ chức</label>

                <select [(ngModel)]="dataRole.orgId" name="orgId" class="form-control selectpicker" data-style="btn-white">
                <option *ngFor="let org of orgs" value="{{org.id}}">{{org.name}}</option>
              </select>

              </div>
            </div>
            <div class="col-md-5 col-xs-5">
              <div class="form-group">
                <label for="status">Vai trò</label>
                <select [(ngModel)]="dataRole.roleId" name="roleId" class="form-control selectpicker" data-style="btn-white">
                           <option *ngFor="let role of roles" value="{{role.id}}">{{role.name}}</option>
                          
                       </select>
              </div>
            </div>
            <div class="col-md-2 col-xs-2">
              <div class="form-group" style="padding-top: 24px">
                <button type="button" (click)="addRole()" class="btn btn-primary form-control">
                  Thêm
              </button>
              </div>
            </div>
            <hr>

          </div>
          <div class="row" *ngIf="dataRoles.length>0">
            <table class="table m-0">
              <thead>
                <tr>
                  <th>STT</th>
                  <th>Tổ chức</th>
                  <th>Vai trò</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let roleSelected of dataRoles">
                  <th scope="row">{{index}}</th>
                  <td>{{getOrgName(roleSelected.orgId)}}</td>
                  <td>{{getRoleName(roleSelected.roleId)}}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <button type="submit" class="btn btn-default waves-effect waves-light">Lưu</button>
          <button type="button" class="btn btn-danger waves-effect waves-light m-l-10" (click)="lgModal.hide()">Hủy</button>
        </form>

      </div>
    </div>
  </div>
</div>